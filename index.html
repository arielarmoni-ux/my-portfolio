<script>
    async function loadContent() {
        const grid = document.getElementById('portfolio-grid');
        const sideList = document.getElementById('side-project-list');
        
        try {
            const response = await fetch('./list.txt');
            if (!response.ok) throw new Error("list.txt not found");
            
            const text = await response.text();
            // פיצול שורות וניקוי רווחים/תווים נסתרים
            const folders = text.split(/\r?\n/).map(f => f.trim()).filter(f => f !== "");

            for (const f of folders) {
                try {
                    // בדיקה אם הקובץ info.txt קיים לפני שממשיכים
                    const infoRes = await fetch(`./images/${f}/info.txt`);
                    if (!infoRes.ok) {
                        console.warn(`Missing info.txt in: ${f}`);
                        continue; 
                    }
                    
                    const infoText = await infoRes.text();
                    const title = infoText.split('\n')[0].trim();
                    const link = `project.html?folder=${f}`;
                    
                    sideList.innerHTML += `<a href="${link}">${title}</a>`;
                    grid.innerHTML += `
                        <a href="${link}">
                            <div class="project-card">
                                <img src="./images/${f}/cover.jpg" alt="${title}" onerror="this.src='https://via.placeholder.com/600x400?text=Check+Image+Name'">
                                <div class="project-overlay">
                                    <div class="project-title">${title}</div>
                                </div>
                            </div>
                        </a>`;
                } catch(e) { console.error(`Error loading folder ${f}:`, e); }
            }
        } catch(e) { console.error("Main load error:", e); }
    }
    loadContent();
</script>
