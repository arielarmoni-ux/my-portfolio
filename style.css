<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project | Ariel Armoni</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="loader"></div>
    
    <a id="back-to-top" title="Back to Top">&#8593;</a>
    <a href="#" id="prev-project" class="nav-arrow">&#8592;</a>
    <a href="#" id="next-project" class="nav-arrow">&#8594;</a>

    <div id="site-wrapper">
        <header>
            <div class="nav-wrapper"><button class="menu-toggle" id="menu-btn"><span></span><span></span><span></span></button></div>
            <h1 id="project-title" style="font-size: 20px; letter-spacing: 4px; text-transform: uppercase; font-weight: 400; margin: 0;"></h1>
        </header>
        
        <div id="project-meta" class="project-meta"></div>
        <div id="project-desc" class="project-description"></div>
        <main id="gallery" class="gallery"></main>
    </div>

    <script src="sidebar.js"></script>
    <script>
        // לוגיקת הופעת כפתור חזרה למעלה בזמן גלילה
        window.onscroll = function() {
            const btn = document.getElementById("back-to-top");
            if (document.documentElement.scrollTop > 300) btn.classList.add("visible");
            else btn.classList.remove("visible");
        };
        // גלילה חלקה למעלה בלחיצה
        document.getElementById("back-to-top").onclick = () => window.scrollTo({top: 0, behavior: 'smooth'});

        async function initProject() {
            const params = new URLSearchParams(window.location.search), currentFolder = params.get('folder');
            const loader = document.getElementById('loader');
            if(!currentFolder) return;
            
            try {
                // לוגיקת חצי ניווט (הקודם/הבא)
                const listRes = await fetch(`${baseURL}/list.txt?v=${Date.now()}`);
                const folders = (await listRes.text()).split(/\r?\n/).map(f => f.trim()).filter(f => f !== "");
                const idx = folders.indexOf(currentFolder);
                document.getElementById('prev-project').href = `project.html?folder=${folders[(idx === 0) ? folders.length - 1 : idx - 1]}`;
                document.getElementById('next-project').href = `project.html?folder=${folders[(idx === folders.length - 1) ? 0 : idx + 1]}`;

                // טעינת טקסטים מ-info.txt
                const res = await fetch(`${baseURL}/images/${currentFolder}/info.txt?v=${Date.now()}`);
                const lines = (await res.text()).split('\n').map(l => l.trim()).filter(l => l !== "");
                document.getElementById('project-title').innerText = lines[0];
                
                const meta = document.getElementById('project-meta'), desc = document.getElementById('project-desc');
                for(let i=1; i<lines.length; i++) {
                    if(lines[i].includes(":")) {
                        const [k, ...v] = lines[i].split(":");
                        meta.innerHTML += `<div class="meta-item"><span class="label">${k.trim()}:</span><span class="value">${v.join(":").trim()}</span></div>`;
                    } else { desc.innerText = lines[i]; }
                }
                
                // טעינת גלריית תמונות (1 עד 30)
                const gal = document.getElementById('gallery');
                for(let i=1; i<=30; i++) {
                    const img = new Image();
                    img.src = `${baseURL}/images/${currentFolder}/${i}.jpg`;
                    img.onload = () => { img.style.order = i; gal.appendChild(img); };
                }
            } catch(e) { console.error(e); }
            
            loader.classList.add('hidden');
        }
        initProject();
    </script>
</body>
</html>
