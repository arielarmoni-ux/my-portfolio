<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project | Ariel Armoni</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <a href="#" id="prev-project" class="nav-arrow" style="left: 2%;">&#8592;</a>
    <a href="#" id="next-project" class="nav-arrow" style="right: 2%;">&#8594;</a>

    <div id="site-wrapper">
        <header>
            <div class="nav-wrapper">
                <button class="menu-toggle" id="menu-btn">
                    <span></span><span></span><span></span>
                </button>
            </div>
            <a href="index.html" class="logo">ARIEL ARMONI</a>
            <div class="sub-logo" style="font-size: 13px; letter-spacing: 2px; color: #888; text-transform: uppercase; margin-top: 8px;">Exhibition Architecture</div>
        </header>

        <main>
            <div style="text-align: center; padding: 60px 5% 20px;">
                <h1 id="project-title" style="font-size: 20px; letter-spacing: 4px; text-transform: uppercase; font-weight: 400; margin-bottom: 25px;"></h1>
                <div id="project-meta" class="project-meta"></div>
                <div id="project-desc" class="project-description"></div>
            </div>

            <div id="gallery" class="gallery"></div>
        </main>
    </div>

    <script src="sidebar.js"></script>
    <script>
        async function initProject() {
            const folder = new URLSearchParams(window.location.search).get('folder');
            if(!folder) return;

            try {
                // ניווט בין פרויקטים
                const resList = await fetch(`${baseURL}/list.txt?v=${Date.now()}`);
                const folders = (await resList.text()).split(/\r?\n/).map(f => f.trim()).filter(f => f !== "");
                const idx = folders.indexOf(folder);
                
                if (idx !== -1) {
                    document.getElementById('prev-project').href = `project.html?folder=${folders[idx <= 0 ? folders.length-1 : idx-1]}`;
                    document.getElementById('next-project').href = `project.html?folder=${folders[idx >= folders.length-1 ? 0 : idx+1]}`;
                }

                // טעינת תוכן הפרויקט (info.txt)
                const res = await fetch(`${baseURL}/images/${folder}/info.txt?v=${Date.now()}`);
                const lines = (await res.text()).split(/\r?\n/).map(l => l.trim()).filter(l => l !== "");
                
                document.getElementById('project-title').innerText = lines[0];
                
                const metaDiv = document.getElementById('project-meta');
                const descDiv = document.getElementById('project-desc');

                lines.slice(1).forEach(line => {
                    if(line.includes(":")) {
                        const [k, ...v] = line.split(":");
                        metaDiv.innerHTML += `
                            <div class="meta-item">
                                <span class="label">${k.trim()}:</span>
                                <span class="value">${v.join(":").trim()}</span>
                            </div>`;
                    } else { 
                        descDiv.innerText += (descDiv.innerText ? "\n\n" : "") + line; 
                    }
                });

                // טעינת תמונות הגלריה
                const gallery = document.getElementById('gallery');
                for(let i=1; i<=30; i++) {
                    const img = new Image();
                    img.src = `${baseURL}/images/${folder}/${i.toString().padStart(2, '0')}.jpg`;
                    img.onload = () => { 
                        img.style.display="block"; 
                        gallery.appendChild(img); 
                    };
                }
            } catch(e) { console.error("Error loading project:", e); }
        }
        initProject();
    </script>
</body>
</html>
